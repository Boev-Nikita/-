Спринт 19/32 - Тема 1/2 - Первый проект
# Проект: Предсказание рисков сердечного приступа

**Описание проекта:** разработать модель машинного обучения по предсказанию риска сердечного приступа.

**Описание датафреймов:**\
1 heart_train.csv - тренировочная выборка.\
2 heart_test.csv - тестовая выборка, по которой нужно получить предсказание.

**Описание признаков датафреймов:**\
1 Unnamed: 0 - порядковый номер пациента в датафрейме, я полагаю.\
2 Age - влзраст пациента.\
3 Cholesterol - уровень холестирина пациента.\
4 Heart rate - частота сердеченых сокращений. \
5 Diabetes - наличие диабета у пациента. \
6 Family History - наличие у пациента истории семьи (болезней родственников).\
7 Smoking - курит ли пациент.\
8 Obesity - ожирение пациента. \
9 Alcohol Consumption -  употребление алкоголя (да / нет).\
10 Exercise Hours Per Week - количество часов упражнений в неделю.\
11 Diet - тип диеты пациента.\
12 Previous Heart Problems - проблемы с сердцем в прошлом.\
13 Medication Use - применение лекарств.\
14 Stress Level - уровень стресса пациента. \
15 Sedentary Hours Per Day - часы сидячего образа жизни в день.\
16 Income - доход пациента.\
17 BMI - индекс массы тела.\
18 Triglycerides - уровень триглицеридов пациента.\
19 Physical Activity Days Per Week - количество дней в неделю с физической активностью.\
20 Sleep Hours Per Day - количество часов сна в день.\
21 Heart Attack Risk (Binary) - риск сердечного приступа (целевой признак).\
22 Blood sugar - уровень сахара крови пациента.\
23 CK-MB - креатинин-киназа MB (потенциальный кандидат на удаление, т.к. этот показатель смотрится у пациентов уже ПОСЛЕ сердечного приступа).\
24 Troponin - тропонин, белок, который появляется в крови при разрушении сердечной мышцы (потенциальный кандидат на удаление, т.к. этот показатель смотрится у пациентов уже ПОСЛЕ сердечного приступа).\
25 Gender - пол пациента.\
26 Systolic blood pressure - систолическое давление пациента.\
27 Diastolic blood pressure - диастолическое давление пациента. \
28 id.

**Ход исследования (для каждой из задач):**\
1 Загрузка данных - загрузка и изучение информации из датасетов.\
2 Предобработка данных - обработка пропущенных значений, поиск дубликатов.\
3 Исследовательский анализ данных - изучение основных данных из датафреймов, их распределения, поиск зависимостей.\
4 Обучение моделей - для отбора лучшей модели машинного обучения и оценки важности признаков для лучшей модели.\
5 Оценка важности признаков для лучшей модели и построение графиков важности с помощью метода SHAP.\
6 Получение пердсказаний на тестовой выборке и сохранение лучшей модели.

**Общий вывод:** 

1 Датафреймы сохранены в htrain и htest.

2 Проведена оценка пропусков, дубликатов и аномальных значений в датафрейме.

3 Проведен исследовательский анализ данных:
3.1 Age: пациенты с риском имеют возраст в диапазоне 0.044-0.854, пациенты без риска - 0-1.\
3.2 Hear rate: пациенты с риском имеют показатель в диапазоне 0.018-0.082, пациенты без риска - 0-0.105.\
3.3 Physical Activity Days Per Week: половина значений показателя у пациентов с риском находится в диапазоне 1-6, у пациентов без риска - 2-6.\
3.4 Blood sugar: как минимум половина всех значений равна медиане (0.227). Так не бывает, скорее всего так заполняли пропуски.\
3.5 Systolic blood pressure: пациенты с риском имеют показатель в диапазоне 0.161-0.742, пациенты без риска - 0-1.\
3.6 Diastolic blood pressure: пациенты с риском имеют показатель в диапазоне 0.209-0.791, пациенты без риска - 0-1.\
3.7 Diabetes: самая большая группа датафрейма - пациенты без риска и с сахарным диабетом, самая маленькая группа - пациенты с риском и без сахарного диабета.\
3.8 Diet: есть 4 диеты (0, 1, 2, 3). У пациентов на диете 3 риска нет.\
3.9 Smoking - большинство пациентов в датафрейме (4908) - курят.

4 Проведено обучение 14 моделей машинного обучения. В качестве основых метрик оценки были f1 (т.к. нам важно и Recall и Precision) и Accuracy. Среди всех моделей выбрана лучшая: модель № 9 (LGBMClassifier) со следующеми характеристиками: LGBMClassifier(class_weight='balanced', learning_rate=0.2, max_depth=7, min_child_samples=14, n_estimators=125, num_leaves=76, random_state=42, verbose=-1).\

5 Проведен анализ важности факторов модели:\
5.1 Diet (0.7) - а именно тип 3 (пациенты на этой диете не имеют риска сердечного приступа).\
5.2 Systilic Blood Presuure (0.46) - чем оно ниже, тем меньше риск.\
5.3 Sedentary Hours Per Day (0.39).\
5.4 Exercise Hours Per Week (0.36).\
5.5 Cholesterol (0.35).\
5.6 Triglycerides (0.34).\
5.7 Heart Rate (0.29) - чем оно меньше, тем меньше риск.\
5.8 Diastolic Blood Pressure (0.29).\
5.9 BMI (0.28)\
5.10 Income (0.28)\
5.11 Stress Level (0.27) - неожиданно, чем лн выше, тем меньше риск сердечного приступа.\
5.12 Blood Sugar (0.23).\
5.13 Age (0.22) - чем меньше возраст, тем меньше риск.\
5.14 Family History 1.0 (0.21) - если она известна, то риск сердечного приступа выше (либо потому что такие пациенты лучше изучены, либо генетика).\
5.15 Sleep Hours Per Day (0.2) - чем меньше человек спит, тем выше риск.

6 Проведено обучние лучшей модели на тестовой выборке, сохранение предсказанных результатов (heart_pred) и лучшей модели (model9.pkl).

**P.S:** По поводу отсутствия приложения - оно будет после нормального спринта по этой теме. Разобраться в этой сфере за 2 недели при помощи одного двухчасового вебинара человеку без опыта в IT - нереально.
